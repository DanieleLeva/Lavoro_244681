<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script src="https://oop.polito.it/js/plotly-latest.min.js"></script>
    <script src="https://oop.polito.it/js/jquery-3.2.1.min.js"></script>
</head>
<body>
<div id="bar"></div>

<script>
    window.onload = function() {
        Plotly.d3.csv("soddisfazione.csv", function (error, data) {
                if (error) {
                    console.log("Impossibile caricare i dati: " + error);
                    return;
                }
                var anno = [];
                var bicicletta = [];
                var auto = [];
                var metropolitana = [];
                var treno = [];
                var autobus = [];
                var aereo = [];
                for (var i = 0; i < data.length; i++) {
                    anno.push(data[i].Anno);
                    bicicletta.push(+data[i].Bicicletta);
                    auto.push(+data[i].Auto);
                    metropolitana.push(+data[i].Metropolitana);
                    treno.push(+data[i].Trenolocale);
                    autobus.push(+data[i].Autobus);
                    aereo.push(+data[i].Aereo);
                }

                var traces = [
                    {
                        name: "Bicicletta",
                        y: anno,
                        x: bicicletta,
                        type: "bar",
                        orientation: "h",
                        hoverinfo: "x+y"
                    },
                    {
                        name: "Auto",
                        y: anno,
                        x: auto,
                        type: "bar",
                        orientation: "h",
                        hoverinfo: "x+y"
                    },
                    {
                        name: "Metropolitana",
                        y: anno,
                        x: metropolitana,
                        type: "bar",
                        orientation: "h",
                        hoverinfo: "x+y"
                    },
                    {
                        name: "Treno",
                        y: anno,
                        x: treno,
                        type: "bar",
                        orientation: "h",
                        hoverinfo: "x+y"
                    },
                    {
                        name: "Autobus",
                        y: anno,
                        x: autobus,
                        type: "bar",
                        orientation: "h",
                        hoverinfo: "x+y"
                    },
                    {
                        name: "Aereo",
                        y: anno,
                        x: aereo,
                        type: "bar",
                        orientation: "h",
                        hoverinfo: "x+y"
                    }];

                var layout = {
                    width: 600, height: 600,
                    title: "Soddisfazione degli utenti, anni 2015-2017",
                    yaxis: {title: "Anni  ", autorange: 'reversed'},
                    xaxis: {range:[55,95], title: "% di voti superiore a 6/10"},
                };

                Plotly.plot("bar", traces, layout, {displayModeBar: true});
        });
    }
    </script>


        </body>
</html>
